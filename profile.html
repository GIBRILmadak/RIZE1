<!doctype html>
<html lang="fr">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>RIZE | Tracez votre progression</title>
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Outfit:wght@400;600;700;800&display=swap"
            rel="stylesheet"
        />
        <!-- Web icon and branding -->
        <link rel="icon" type="image/svg+xml" href="icons/logo.png" />
        <link rel="shortcut icon" href="icons/logo.png" />
        <meta name="theme-color" content="#050505" />
        <meta
            name="description"
            content="RIZE - Plateforme de suivi de progression transparente sans dopamine sociale"
        />
        <!-- Styles globaux -->
        <link rel="stylesheet" href="css/style.css" />
        <link rel="stylesheet" href="css/search-notification.css" />
        <link rel="stylesheet" href="css/arcs.css" />
        <link rel="stylesheet" href="css/streaming-analytics.css" />
        <!-- Supabase JS -->
        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    </head>
    <body class="profile-open">
        <!-- Container pour les notifications Toast -->
        <div id="toast-container"></div>

        <!-- Overlay Immersif -->
        <div id="immersive-overlay">
            <!-- Contenu injecté dynamiquement -->
        </div>

        <!-- Modale Réglages -->
        <div id="settings-modal">
            <div class="settings-container">
                <!-- Contenu injecté dynamiquement -->
            </div>
        </div>

        <!-- Modale Création -->
        <div id="create-modal">
            <div class="create-container">
                <!-- Contenu injecté dynamiquement -->
            </div>
        </div>

        <!-- Panneau de Notifications -->
        <div id="notification-panel" class="notification-panel">
            <div class="notification-panel-header">
                <h3 class="notification-panel-title">Notifications</h3>
                <span
                    class="notification-mark-all"
                    onclick="markAllNotificationsAsRead()"
                    >Tout marquer comme lu</span
                >
            </div>
            <div id="notification-list" class="notification-list">
                <!-- Notifications injectées dynamiquement -->
            </div>
        </div>

        <nav>
            <a
                class="logo"
                onclick="navigateTo('discover')"
                style="cursor: pointer"
            >
                <div class="logo-img">
                    <img src="icons/logo.png" alt="RIZE - Logo" />
                </div>
                <span>RIZE</span>
            </a>
            <div class="nav-links">
                <a onclick="navigateTo('discover')"> discover</a>
                <a onclick="handleProfileNavigation()" id="nav-profile"
                    >Ma Trajectoire</a
                >

                <!-- Bouton Notifications -->
                <div
                    class="notification-button"
                    onclick="toggleNotificationPanel()"
                    style="display: none"
                    id="notification-btn"
                >
                    <svg
                        class="notification-icon"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                    >
                        <path
                            d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"
                        ></path>
                        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                    </svg>
                    <span
                        id="notification-badge"
                        class="notification-badge"
                    ></span>
                </div>

                <a href="#" id="nav-auth">Login / Register</a>
            </div>
        </nav>

        <!-- BOUTON RÉGLAGES (FIXED POSITION) -->
        <div id="settings-button-container"></div>

        <!-- PROFIL (TIMELINE) -->
        <section id="profile" class="page active">
            <div class="container profile-container">
                <!-- Contenu injecté dynamiquement -->
            </div>
        </section>

        <!-- Configuration Supabase -->
        <script src="js/supabase-config.js"></script>
        <script src="js/influence.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
        <script src="js/analytics.js"></script>
        <!-- Améliorations UX -->
        <script src="js/ux-enhancements.js"></script>
        <script src="js/app-enhancements.js"></script>
        <!-- Modules de fonctionnalités -->
        <script src="js/search.js"></script>
        <script src="js/notifications.js"></script>
        <script src="js/file-upload.js"></script>
        <script src="js/arcs.js"></script>
        <!-- Script principal avec intégration Supabase -->
        <script src="js/app-supabase.js"></script>

        <script>
            // Initialiser les fonctionnalités au chargement
            document.addEventListener("DOMContentLoaded", function () {
                // Initialiser la recherche
                initializeSearch();

                // Initialiser les notifications si l'utilisateur est connecté
                if (currentUser) {
                    initializeNotifications();
                    document.getElementById("notification-btn").style.display =
                        "flex";
                }
            });
        </script>
    </body>
</html>
